# Puzzle Session UI Refinement 计划（2025-11-30）

> 聚焦 Puzzle Session 里的视觉一致性：QuadrantSpawner pill 按钮、PuzzlePiece 颜色梯度、CenterCard 可读性、Mascot 气泡风格，以及四角 Spawner 布局微调。保持现有架构（Board → QuadrantSpawner/PuzzlePiece/CenterCard/Mascot + constants）不变，只做 UI 层 vertical slice。

## 核心模块 & 目标

- **frontend/Board（Puzzle Session 布局）**  
  管理网格背景、CenterCard、PuzzlePiece 列表与四个 QuadrantSpawner 的布局。更新 Spawner 位置（更靠四角），确保新的 CenterCard 尺寸居中不偏移。

- **frontend/QuadrantSpawner（corner hubs）**  
  将白色方块 + Plus icon 改为实心彩色 pill button（label 在内部），使用 quadrant palette 100% 不透明色作为背景，同时保留 drag 交互与 currentLabel 摇晃逻辑。

- **frontend/PuzzlePiece（piece 渲染）**  
  移除 opacity-based fading；利用 `getDistanceAdjustedColor()` 基于距中心的距离调整饱和度/亮度，让中心更饱和/偏深、外圈更浅更亮，并保持拖拽时整块 100% 不透明。

- **frontend/CenterCard（中央问题卡片）**  
  配合 `CENTER_CARD_WIDTH/HEIGHT` 从 2x2 扩到 4x3 grid units，移除内部网格纹理 overlay，放大加粗 centralQuestion typography，保证 central question 在 Puzzle Session 中视觉上成为第一焦点。

- **frontend/Mascot（Puzzle 内） & frontend/MascotButton（Home Canvas）**  
  对齐 Mascot speech bubble 视觉：统一使用 `#FFB5FA` 粉色背景、`#1C1C1C` 文案颜色、较锐利的圆角（pixel-ish）、去掉玻璃模糊；调整布局让气泡在视觉上与 mascot 垂直居中。

- **constants/colors & constants/puzzleGrid（配色 & 网格常量）**  
  校准 quadrant base color 映射，让 `FORM` 为 blue、`MOTION` 为 green（符合 Figma）；保留 `QUADRANT_PALETTE` 与 `getDistanceAdjustedColor()` 作为单一颜色源；将 `CENTER_CARD_WIDTH/HEIGHT` 更新为 4x3。

## Vertical Slice（本次改动范围）

1. **Colors & Grid Constants**  
   - 更新 `constants/colors.ts` 中 `QUADRANT_COLORS` 映射（Form=blue, Motion=green），确保 `constants/puzzleGrid.ts` 的 `COLORS` 使用新配色。  
   - 将 `CENTER_CARD_WIDTH=4`, `CENTER_CARD_HEIGHT=3`，维持中心定位计算逻辑。

2. **QuadrantSpawner Pill Buttons**  
   - 在 `components/puzzle/QuadrantSpawner.tsx` 中移除 `Plus` icon 与外置 label；改用 `w-20 h-10 rounded-full` 彩色 pill，文字为 `label`（“Form/Motion/Expression/Function”）居中。  
   - 保留 drag ghost（shape cells + currentLabel shake），不引入新的 state。

3. **PuzzlePiece 颜色梯度**  
   - 在 `components/puzzle/PuzzlePiece.tsx` 中删除基于 `distance` 的 opacity 计算与 `data.color + 'FF'/'CC'` 渐变。  
   - 引入 `getDistanceAdjustedColor(data.color, distance)`，直接作为背景色（100% 不透明），拖拽/invalid 状态仍通过 border/shadow 表达。

4. **CenterCard 可读性**  
   - 调整 `components/puzzle/CenterCard.tsx`：移除内部网格 overlay，仅保留暗色背景 + 外侧阴影。  
   - 提升 centralQuestion 文案字号/行高/字重（例如 `text-lg`/`text-xl` + `font-semibold`/`font-bold`），适当增大 padding，让 4x3 卡片显得稳重易读。

5. **Mascot Speech Bubble 对齐**  
   - 在 `components/puzzle/Mascot.tsx` 中将气泡改为粉色背景 + 深色文本 + 较小圆角，去掉 `backdrop-blur` 与白色基色；容器 `flex` 改为 `items-center` 以便垂直居中。  
   - 在 `components/mascot/MascotButton.tsx` 中统一气泡配色（背景 `#FFB5FA`、文字 `#1C1C1C`、箭头颜色同步），通过绝对定位（`top-1/2 -translate-y-1/2`）让气泡与 mascot 垂直对齐。

6. **Spawner 位置微调**  
   - 更新 `components/puzzle/Board.tsx` 中四个 `QuadrantSpawner` 的 `className`：  
     - Form: `top-20 left-6`  
     - Motion: `top-20 right-6`  
     - Expression: `bottom-20 left-6`  
     - Function: `bottom-20 right-6`

7. **验证 & 回归**  
   - 运行 `npm run build`，确认无 TypeScript error、无 import/prop 类型不匹配。  
   - 手动 sanity check：中心卡片仍居中、QuadrantSpawner 可正常 drag 出 pieces、Mascot 气泡动画未被破坏。

